<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>IP Test</title>
</head>
<body>
    <h1>IP API Test</h1>
    <button onclick="testIP()">Get IP</button>
    <pre id="result">Click button to test...</pre>

    <script>
        async function testIP() {
            document.getElementById('result').textContent = 'Testing...';

            const apis = [
                'https://api.ipify.org?format=json',
                'https://ip.sb/api/ip',
                'https://ifconfig.me/ip',
            ];

            for (const api of apis) {
                try {
                    console.log('Trying:', api);
                    const response = await fetch(api, { mode: 'no-cors' });
                    console.log('Response status:', response.status);

                    const text = await response.text();
                    console.log('Response text:', text);

                    if (api.includes('ipify') || api.includes('ip.sb')) {
                        // These return JSON
                        const json = JSON.parse(text);
                        document.getElementById('result').textContent = `Success: ${json.ip}`;
                        return;
                    } else {
                        // Plain text
                        const ip = text.trim();
                        if (ip.match(/\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/)) {
                            document.getElementById('result').textContent = `Success: ${ip}`;
                            return;
                        }
                    }
                } catch (e) {
                    console.log('Failed:', api, e);
                }
            }

            document.getElementById('result').textContent = 'All APIs failed';
        }
    </script>
</body>
</html>
